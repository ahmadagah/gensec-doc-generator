# 08.2: Command agents

## 3. Linux processes

- Using sudo , find the names of all processes with open network connections using lsof
- Show the path of the executable file used to launch sshd
- Show all processes whose original binaries have been deleted
- Show the current working directory of the Python process
- Find the PID of the python processes, then use /proc to show its environment
- Show all processes which have the current working directory of /tmp
- Show all scheduled tasks

## 4. Linux files and regular expressions (grep)

- How many passwords begin with the letter a
- How many passwords begin with the number 1
- How many passwords consist of only alphabetic characters
- How many passwords are made up of exactly 6 numbers
- List all passwords in rockyou.txt that begin abcde and end with the number 9

## 5. Linux file searching (find)

- Find all setuid and setgid programs in /bin
- Find all ELF executables in /bin
- Find all files modified in the last day in /etc
- Find all files created in the last day in /etc
- Find all ssh authorized_keys files in /home
- Find all history files in user directories that have size 0

## 6. Linux firewall

- What command allows ssh traffic from 131.252.220.0/24?
- What command allows incoming connections to ports 80 and 443 from 131.252.0.0/16?
- What command allows outgoing connections to a MySQL database server at 10.0.0.10?
- What command denies all traffic from 1.1.1.1

## 7. Linux audit logs

- Find all currently logged in users
- Find the last 5 successful logins
- Find the last 5 unsuccessful logins and the IP addresses they came from
- Find the last 5 logins from the root user

## 8. Linux package vulnerabilities

- What is the ssh server being run on this machine?
- Does the current ssh server being run have any vulnerabilities associated with it?
- What is the ssh server being run on this machine?
- Does the current ssh server being run have any vulnerabilities associated with it?
- Did the answers provided by the two agents differ?
- Which agent gave the more accurate answer?

## 9. tcpdump

- Show the results of the agent for each query.

## 10. nmap

- The services that are running on them
- The version of the operating system they are running
- The web server software that is running on them

## 11. -

- Use nmap 's http-enum to find directories at WFP1_Internal
- Use nmap 's http-brute script on the path /authentication/example1 for the web server at WFP2_Internal

## 12. sqlmap

- Use sqlmap in batch mode to get the passwords from the URL
- What sqlmap command is performed?
- What steps did sqlmap take to access the passwords?
- Use sqlmap in batch mode to dump the database via the URL
- What sqlmap command is performed?
- What steps did sqlmap take to access the passwords?
- Use sqlmap in batch mode to test the URL
- What sqlmap command is performed?
- What steps did sqlmap take to access the passwords?

## 13. -

- Use sqlmap in batch mode to find the passwords in the database at the following URL
- What sqlmap command is performed?
- What steps did sqlmap take to access the passwords?
- Go back to the site and enter the username and password found. Did they work?
- Using the agent, develop a prompt that will generate the command above that can be used to automatically dump the database.
- Note that if you execute the command, it will take around 10 minutes to dump the entire database.

## 15. -

- Give the URL to the agent, then look at the command output for Commix.
- What was used to determine that the URL was vulnerable to command injection?
- Use whoami to find which user you are logged in as
- Give the URL to the agent, then look at the command output for Commix.
- What was used to determine that the URL was vulnerable to command injection?
- How does it differ from the prior URL?
